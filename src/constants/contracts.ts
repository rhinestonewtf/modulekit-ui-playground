import { Hex } from "viem";
import { Account } from "../domains/Account";
import { Validator } from "../domains/Module/Module";
import { signUserOpHash } from "../domains/UserOperation/api/signUserOp";
import { signMessage } from "@wagmi/core";
import { wagmiConfig } from "../app/(app)/Providers";

export type ContractDependencies = {
  [name: string]: Hex;
};

export type ValidatorList = {
  [name: string]: Validator;
};

export const validators: ValidatorList = {
  ecdsa: {
    name: "ecdsa",
    address: "0x19826F42C27961355b652daAC8282b85BD5b1cF9",
    mockSignature:
      "0xe8b94748580ca0b4993c9a1b86b5be851bfc076ff5ce3a1ff65bf16392acfcb800f9b4f1aef1555c7fce5599fffb17e7c635502154a0333ba21f3ae491839af51c",
    signMessageAsync: async (message: Hex, activeAccount: Account) => {
      return await signMessage(wagmiConfig, { message: { raw: message } });
    },
  },
  webauthn: {
    name: "webauthn",
    address: "0xccAec32B52795A11de7D21aB45238C5Fc9146fB5",
    mockSignature:
      "0x00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000001161757468656e74696361746f7244617461000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e636c69656e744461746148617368000000000000000000000000000000000000",
    signMessageAsync: async (message: Hex, activeAccount: Account) => {
      return await signUserOpHash(message, activeAccount);
    },
  },
};

export const contracts: ContractDependencies = {
  // CORE
  ENTRY_POINT_ADDRESS: "0x0000000071727De22E5E9d8BAf0edAc6f37da032",
  ACCOUNT_FACTORY_ADDRESS: "0xDC15682AEDba36Cf3121507993b50Ef22b457053",
  SINGLETON_ADDRESS: "0xa951A1179bA8bd08b8140aB9dc7910AF08AE7181",
  REGISTRY_ADDRESS: "0x000000000069E2a187AEFFb852bF3cCdC95151B2",

  // MODULES
  ECDSA_VALIDATOR_ADDRESS: "0x19826F42C27961355b652daAC8282b85BD5b1cF9", // ownable validator
  WEBAUTHN_VALIDATOR_ADDRESS: "0xccAec32B52795A11de7D21aB45238C5Fc9146fB5",

  // UTILITIES
  BOOTSTRAP_ADDRESS: "0x1E919660050C68BFEf868945Cf5f9a26ad7E360b",
};
