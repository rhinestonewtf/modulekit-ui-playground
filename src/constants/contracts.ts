import { Hex } from "viem";
import { signMessage } from "@wagmi/core";
import { Account } from "../domains/Account";
import { Validator } from "../domains/Module/Module";
import { signUserOpHash } from "../domains/UserOperation/api/signUserOp";

export type ContractDependencies = {
  [name: string]: Hex;
};

export type ValidatorList = {
  [name: string]: Validator;
};

export const validators: ValidatorList = {
  ecdsa: {
    name: "ecdsa",
    address: "0xf83d07238a7c8814a48535035602123ad6dbfa63",
    mockSignature:
      "0xe8b94748580ca0b4993c9a1b86b5be851bfc076ff5ce3a1ff65bf16392acfcb800f9b4f1aef1555c7fce5599fffb17e7c635502154a0333ba21f3ae491839af51c",
    signMessageAsync: async (message: Hex, activeAccount: Account) => {
      return await signMessage({ message });
    },
  },
  webauthn: {
    name: "webauthn",
    address: "0xB236CDE7e68431D874FD90E10b1910af5DC45DAc",
    mockSignature:
      "0x07855b46a623a8ecabac76ed697aa4e13631e3b6718c8a0d342860c13c30d2fc00000000000000000000000000000000000000000000000000000000000000e0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000024456b4f30bac4a8994b010d127650e6f22669f7f7aec4475f80f8c2a8d2ed02872b0aca713e929d8a28596b42f325fa9587a16a8eb2bc07e4b3a3e9c14a7b988100000000000000000000000000000000000000000000000000000000000000251584482fdf7a4d0b7eb9d45cf835288cb59e55b8249fff356e33be88ecc546d11d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000957b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a22307831383138356261383531633032383032323035366564396634326261313434396532613138663739323932326238383939363937313962616665373861653563222c226f726967696e223a2268747470733a2f2f646576656c6f706d656e742e666f72756d64616f732e636f6d227d0000000000000000000000",
    signMessageAsync: async (message: Hex, activeAccount: Account) => {
      return await signUserOpHash(message, activeAccount);
    },
  },
};

export const contracts: ContractDependencies = {
  // CORE
  ENTRY_POINT_ADDRESS: "0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789",
  ACCOUNT_FACTORY_ADDRESS: "0xFf81C1C2075704D97F6806dE6f733d6dAF20c9c6",
  SINGLETON_ADDRESS: "0x76104AE8aeCfc3aEC2AA6587b4790043d3612c47",
  REGISTRY_ADDRESS: "0x500684cBaa280aDf80d5ACf7A32Daebb23162e63",

  // MODULES
  ECDSA_VALIDATOR_ADDRESS: "0xf83d07238a7c8814a48535035602123ad6dbfa63", // ownable validator
  WEBAUTHN_VALIDATOR_ADDRESS: "0xB236CDE7e68431D874FD90E10b1910af5DC45DAc",
  EXTENSIBLE_FALLBACK_HANDLER_ADDRESS:
    "0x42555fEEf301829f84fC1af182f3dAF827De9c6f",

  // UTILITIES
  BOOTSTRAP_ADDRESS: "0x5e9F3feeC2AA6706DF50de955612D964f115523B",
};
